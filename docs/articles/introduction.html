<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Google Site Verification --><meta name="google-site-verification" content="BrjL5fpoyHZu1rR8rwnnM2MBO3u3iIFB8NsmSuOsY84">
<title>Introduction to mlr3pipelines • mlr3pipelines</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="Introduction to mlr3pipelines">
<meta property="og:description" content="">
<meta property="og:image" content="https://mlr3pipelines.mlr-org.com/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
<link rel="apple-touch-icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html"></a>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/a_simple_pipeline.html">A simple pipeline</a>
    </li>
    <li>
      <a href="../articles/basic_concepts.html">Showcase: Basic Concepts: PipeOp and Graph</a>
    </li>
    <li>
      <a href="../articles/branching.html">Showcase: Branching</a>
    </li>
    <li>
      <a href="../articles/stacking_and_bagging.html">Showcase: Bagging and Stacking</a>
    </li>
    <li>
      <a href="../articles/create_a_custom_pipeop.html">Custom PipeOps</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Appendix
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html">Function Reference</a>
    </li>
    <li>
      <a href="../news/index.html">News</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlr-org/mlr3pipelines">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.slack.com">
    <span class="fa fa-slack"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr">
    <span class="fa fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to mlr3pipelines</h1>
                        <h4 class="author">Martin Binder</h4>
            
      
      <!--The 'toc' block was inserted manually by @pat-s. It triggeres the inline ToC in the vignettes.-->
            <div id="toc">
      <h3 class="hasAnchor">
<a href="#toc" class="anchor"></a>Table of Contents</h3>
      <ul>
<li><a href="#whats-the-point">What’s the Point</a></li>
      <li>
<a href="#pipeop-pipeline-operators"><code>PipeOp</code>: Pipeline Operators</a><ul>
<li><a href="#why-the-state">Why the <code>$state</code></a></li>
      <li><a href="#where-to-get-pipeops">Where to Get <code>PipeOp</code>s</a></li>
      </ul>
</li>
      <li>
<a href="#pipeop-channels">PipeOp Channels</a><ul>
<li><a href="#input-channels">Input Channels</a></li>
      <li><a href="#output-channels">Output Channels</a></li>
      <li><a href="#channel-configuration">Channel Configuration</a></li>
      </ul>
</li>
      <li>
<a href="#graph-networks-of-pipeops"><code>Graph</code>: Networks of <code>PipeOp</code>s</a><ul>
<li><a href="#basics">Basics</a></li>
      <li><a href="#networks">Networks</a></li>
      <li><a href="#syntactic-sugar">Syntactic Sugar</a></li>
      </ul>
</li>
      <li>
<a href="#learners-in-graphs-graphs-in-learners">Learners in Graphs, Graphs in Learners</a><ul>
<li><a href="#pipeoplearner"><code>PipeOpLearner</code></a></li>
      <li><a href="#graphlearner"><code>GraphLearner</code></a></li>
      </ul>
</li>
      <li><a href="#hyperparameters">Hyperparameters</a></li>
      </ul>
</div>
      
      <small>Source: <a href="https://github.com/mlr-org/mlr3pipelines/blob/master/vignettes/introduction.Rmd"><code>vignettes/introduction.Rmd</code></a></small>

    </div>

    
    
<div class="contents">
<p>This vignette is an introduction to <code>mlr3pipelines</code>, the dataflow programming toolkit for machine learning in <code>R</code> using <a href="https://github.com/mlr-org/mlr3"><code>mlr3</code></a>. It will quickly mention the basic concepts and then go through a few examples that both show the simplicity as well as the power and versaitility of using <code>mlr3pipelines</code>.</p>
<div id="whats-the-point" class="section level2">
<h2 class="hasAnchor">
<a href="#whats-the-point" class="anchor"></a>What’s the Point</h2>
<p>Machine learning toolkits often try to abstract the processes happening inside machine learning algorithms, making it easy for the user to switch out one algorithm for another without having to worry about what is happening inside them, what kind of data they are able to operate with etc. The benefit of using <code>mlr3</code>, for example, is that one can create a <code>Learner</code>, a <code>Task</code>, a <code>Resampling</code> etc. and use them for typical machine learning operations. It is trivial to exchange individual components and therefore use, for example, a different <code>Learner</code> in the same experiment for comparison.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">task =<span class="st"> </span>TaskClassif<span class="op">$</span><span class="kw">new</span>(<span class="st">"iris"</span>, <span class="kw">as_data_backend</span>(iris), <span class="st">"Species"</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3">lrn =<span class="st"> </span>mlr_learners<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"classif.rpart"</span>)</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5">rsmp =<span class="st"> </span>mlr_resamplings<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"holdout"</span>)</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">resample</span>(task, lrn, rsmp)</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt; INFO [mlr3] Running learner 'classif.rpart' on task 'iris' (iteration 1/1)'</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt; &lt;ResampleResult&gt; of learner 'iris' on task 'classif.rpart' with 1 iterations</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt;     Measure Min. 1st Qu. Median Mean 3rd Qu. Max. Sd</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt;  classif.ce 0.06    0.06   0.06 0.06    0.06 0.06 NA</span></a></code></pre></div>
<p>However, this modularity breaks down as soon as the learning algorithm encompasses more than just model fitting, but instead also things like data preprocessing or meta models. <code>mlr3pipelines</code> takes modularity one step further: it makes it possible to build individual steps within a “<code>Learner</code>” out of building blocks called <strong><code>PipeOp</code>s</strong>.</p>
</div>
<div id="pipeop-pipeline-operators" class="section level2">
<h2 class="hasAnchor">
<a href="#pipeop-pipeline-operators" class="anchor"></a><code>PipeOp</code>: Pipeline Operators</h2>
<p>The most basic unit of functionality within <code>mlr3pipelines</code> is the <strong><code>PipeOp</code></strong>, short for “pipeline operator”, which represents a transformative operation on input (for example a training dataset) leading to output. It can therefore be seen as a generalised notion of a function, with a certain twist: <code>PipeOp</code>s behave differently during a “training phase” and a “prediction phase”. The training phase will typically generate a certain model of the data that is saved as internal state. The prediction phase will then operate on the input data depending on the trained model.</p>
<p>An example of this behaviour is the <em>principal component analysis</em> operation (“<code>PipeOpPCA</code>”): During training, it will transform incoming data by rotating it in a way that leads to uncorrelated features ordered by their contribution to total variance. It will <em>also</em> save the rotation matrix to be used during for new data. This makes it possible to perform “prediction” with single rows of new data, where this row’s scores on each of the principal components of the training data is computed.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">po =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"pca"</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3">po<span class="op">$</span><span class="kw">train</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(task))[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>()</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt;        Species       PC1         PC2         PC3          PC4</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt;   1:    setosa -2.684126  0.31939725 -0.02791483 -0.002262437</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt;   2:    setosa -2.714142 -0.17700123 -0.21046427 -0.099026550</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt;   3:    setosa -2.888991 -0.14494943  0.01790026 -0.019968390</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt;   4:    setosa -2.745343 -0.31829898  0.03155937  0.075575817</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt;   5:    setosa -2.728717  0.32675451  0.09007924  0.061258593</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt;  ---                                                         </span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; 146: virginica  1.944110  0.18753230  0.17782509 -0.426195940</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt; 147: virginica  1.527167 -0.37531698 -0.12189817 -0.254367442</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt; 148: virginica  1.764346  0.07885885  0.13048163 -0.137001274</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt; 149: virginica  1.900942  0.11662796  0.72325156 -0.044595305</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt; 150: virginica  1.390189 -0.28266094  0.36290965  0.155038628</span></a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">single_line_task =<span class="st"> </span>task<span class="op">$</span><span class="kw">clone</span>()<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3">po<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(single_line_task))[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>()</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt;    Species       PC1       PC2         PC3          PC4</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; 1:  setosa -2.684126 0.3193972 -0.02791483 -0.002262437</span></a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">po<span class="op">$</span>state</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt; Standard deviations (1, .., p=4):</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; [1] 2.0562689 0.4926162 0.2796596 0.1543862</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt; Rotation (n x k) = (4 x 4):</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt;                      PC1         PC2         PC3        PC4</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; Petal.Length  0.85667061 -0.17337266  0.07623608  0.4798390</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt; Petal.Width   0.35828920 -0.07548102  0.54583143 -0.7536574</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt; Sepal.Length  0.36138659  0.65658877 -0.58202985 -0.3154872</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; Sepal.Width  -0.08452251  0.73016143  0.59791083  0.3197231</span></a></code></pre></div>
<p>This shows the most important primitives integrated by a <code>PipeOp</code>:</p>
<ul>
<li>
<strong><code>$train()</code></strong>, taking a list of input arguments, turning them into a list of outputs, meanwhile saving a state in <code>$state</code>
</li>
<li>
<strong><code>$predict()</code></strong>, taking a list of input arguments, turning them into a list of outputs, making use of the saved <code>$state</code>
</li>
<li>
<strong><code>$state</code></strong>, the “model” trained with <code>$train()</code> and utilised during <code>$predict()</code>.</li>
</ul>
<div id="why-the-state" class="section level3">
<h3 class="hasAnchor">
<a href="#why-the-state" class="anchor"></a>Why the <code>$state</code>
</h3>
<p>It is important to take a moment and notice the importance of a <code>$state</code> variable and the <code>$train()</code> / <code>$predict()</code> dichotomy in a <code>PipeOp</code>. There are many preprocessing methods, for example scaling of parameters or imputation, that could in theory just be applied to training data and prediction / validation data separately, or they could be applied to a task before resampling is performed. This would, however, be fallacious:</p>
<ul>
<li>The preprocessing on prediction data should not depend on the prediction dataset. A prediction on a single instance of new data should give the same result as prediction performed on a whole dataset.</li>
<li>Performing preprocessing on a task before doing resampling leaks information about the test set into the training set. Resampling should evaluate the generalisation performance of the <em>entire</em> machine learning method, therefore the behaviour of this entire method must only depend on the content of the training split during resampling.</li>
</ul>
</div>
<div id="where-to-get-pipeops" class="section level3">
<h3 class="hasAnchor">
<a href="#where-to-get-pipeops" class="anchor"></a>Where to Get <code>PipeOp</code>s</h3>
<p>Each <code>PipeOp</code> is an instance of an “<code>R6</code>” class, many of which are provided by the <code>mlr3pipelines</code> package itself. They can be constructed explicitly (“<code>PipeOpPCA$new()</code>”) or retrieved from the <code>mlr_pipelines</code> collection: <code>mlr_pipeops$get("pca")</code>. The entire list of available <code>PipeOp</code>s, and some meta-information, can be retrieved using <code>as.data.table()</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">as.data.table</span>(mlr_pipeops)[, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"id"</span>, <span class="st">"input.num"</span>, <span class="st">"output.num"</span>)]</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt;                    id input.num output.num</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt;  1:     backuplearner         2          1</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt;  2:     balancesample         1          1</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt;  3:            branch         1         NA</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt;  4:             chunk         1         NA</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt;  5:              copy         1         NA</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt;  6:            encode         1          1</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt;  7:      featureunion        NA          1</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt;  8:            filter         1          1</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt;  9:            impute         1          1</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt; 10:           learner         1          1</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt; 11:        learner_cv         1          1</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt; 12:      majorityvote        NA          1</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt; 13:          modelavg        NA          1</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt; 14: nloptmajorityvote        NA          1</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt; 15:     nloptmodelavg        NA          1</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt; 16:              null         1          1</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">#&gt; 17:               pca         1          1</span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt; 18:             scale         1          1</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">#&gt; 19:         subsample         1          1</span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">#&gt; 20:          unbranch        NA          1</span></a></code></pre></div>
</div>
</div>
<div id="pipeop-channels" class="section level2">
<h2 class="hasAnchor">
<a href="#pipeop-channels" class="anchor"></a>PipeOp Channels</h2>
<div id="input-channels" class="section level3">
<h3 class="hasAnchor">
<a href="#input-channels" class="anchor"></a>Input Channels</h3>
<p>Just like functions, <code>PipeOp</code>s can take multiple inputs. These multiple inputs are always given as elements in the input list. For example, there is a <code>PipeOpFeatureUnion</code> that combines multiple tasks with different features and “<code><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind()</a></code>s” them together, creating one combined task. When it is given two sections of the <code>iris</code> task, for example, it recreates the original task:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">iris_first_half =<span class="st"> </span>task<span class="op">$</span><span class="kw">clone</span>()<span class="op">$</span><span class="kw">select</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Petal.Length"</span>, <span class="st">"Petal.Width"</span>))</a>
<a class="sourceLine" id="cb6-2" title="2">iris_second_half =<span class="st"> </span>task<span class="op">$</span><span class="kw">clone</span>()<span class="op">$</span><span class="kw">select</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Sepal.Length"</span>, <span class="st">"Sepal.Width"</span>))</a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4">pofu =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"featureunion"</span>, <span class="dt">innum =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-5" title="5"></a>
<a class="sourceLine" id="cb6-6" title="6">pofu<span class="op">$</span><span class="kw">train</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(iris_first_half, iris_second_half))[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>()</a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt;        Species Petal.Length Petal.Width Sepal.Length Sepal.Width</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt;   1:    setosa          1.4         0.2          5.1         3.5</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt;   2:    setosa          1.4         0.2          4.9         3.0</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt;   3:    setosa          1.3         0.2          4.7         3.2</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt;   4:    setosa          1.5         0.2          4.6         3.1</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt;   5:    setosa          1.4         0.2          5.0         3.6</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt;  ---                                                            </span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt; 146: virginica          5.2         2.3          6.7         3.0</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt; 147: virginica          5.0         1.9          6.3         2.5</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt; 148: virginica          5.2         2.0          6.5         3.0</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt; 149: virginica          5.4         2.3          6.2         3.4</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; 150: virginica          5.1         1.8          5.9         3.0</span></a></code></pre></div>
<p>Because <code>PipeOpFeatureUnion</code> effectively takes two input arguments here, we can say it has two <strong>input channels</strong>. An input channel also carries information about the <em>type</em> of input that is acceptable. The input channels of the <code>pofu</code> object constructed above, for examplel, each accept a <code>Task</code> during training and prediction. This information can be queried from the <code>$input</code> slot:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">pofu<span class="op">$</span>input</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt;      name train predict</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt; 1: input1  Task    Task</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; 2: input2  Task    Task</span></a></code></pre></div>
<p>Other <code>PipeOp</code>s may have channels that take different types during different phases. The <code>backuplearner</code> <code>PipeOp</code>, for example, takes a <code>NULL</code> and a <code>Task</code> during training, and a <code>Prediction</code> and a <code>Task</code> during prediction:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"backuplearner"</span>)<span class="op">$</span>input</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt;         name train    predict</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; 1: learnerin  NULL Prediction</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; 2:    taskin  Task       Task</span></a></code></pre></div>
</div>
<div id="output-channels" class="section level3">
<h3 class="hasAnchor">
<a href="#output-channels" class="anchor"></a>Output Channels</h3>
<p>Unlike the typical notion of a function, <code>PipeOp</code>s can also have multiple <strong>output channels</strong>. <code>$train()</code> and <code>$predict()</code> always return a list, so certain <code>PipeOp</code>s may return lists with more than one element. Similar to input channels, the information about the number and type of outputs given by a <code>PipeOp</code> is available in the <code>$output</code> slot. The <code>chunk</code> PipeOp, for example, chunks a given <code>Task</code> into subsets and consequently returns multiple <code>Task</code> objects, both during training and prediction. The number of output channels must be given during construction through the <code>outnum</code> argument.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"chunk"</span>, <span class="dt">outnum =</span> <span class="dv">3</span>)<span class="op">$</span>output</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#&gt;       name train predict</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt; 1: output1  Task    Task</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; 2: output2  Task    Task</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#&gt; 3: output3  Task    Task</span></a></code></pre></div>
</div>
<div id="channel-configuration" class="section level3">
<h3 class="hasAnchor">
<a href="#channel-configuration" class="anchor"></a>Channel Configuration</h3>
<p>Most <code>PipeOp</code>s have only one input channel (and take only a list with a single element), but there are a few with more than one; in many cases, the number of input or output channels is determined during construction, e.g. through the <code>innum</code> / <code>outnum</code> arguments. The <code>input.num</code> and <code>output.num</code> columns of the <code>mlr_pipeops</code>-table <a href="#where-to-get-pipeops">above</a> show the default number of channels, and <code>NA</code> if the number depends on a construction argument.</p>
<p>The default printer of a <code>PipeOp</code> gives information about channel names and types:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"backuplearner"</span>)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt; PipeOp: &lt;backuplearner&gt; (not trained)</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt; values: &lt;method=mode&gt;</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt; Input channels &lt;name [train type, predict type]&gt;:</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt;   learnerin [NULL,Prediction], taskin [Task,Task]</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt; Output channels &lt;name [train type, predict type]&gt;:</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt;   output [NULL,Prediction]</span></a></code></pre></div>
</div>
</div>
<div id="graph-networks-of-pipeops" class="section level2">
<h2 class="hasAnchor">
<a href="#graph-networks-of-pipeops" class="anchor"></a><code>Graph</code>: Networks of <code>PipeOp</code>s</h2>
<div id="basics" class="section level3">
<h3 class="hasAnchor">
<a href="#basics" class="anchor"></a>Basics</h3>
<p>Because each <code>PipeOp</code> has a known number of input and output channels that always produce or accept data of a known type, it is possible to network them together in <strong><code>Graph</code></strong>s. A <code>Graph</code> is a collection of <code>PipeOp</code>s with “edges” between the <code>PipeOp</code>’s channels that mandate that data should be flowing along them.</p>
<p>A <code>Graph</code> is empty when first created, and <code>PipeOp</code>s can be added using the <strong><code>$add_pipeop()</code></strong> method. The <strong><code>$add_edge()</code></strong> method is used to create connections between them. While the printer of a <code>Graph</code> gives some information about its layout, the most intuitive way of visualizing it is using the <code>$plot()</code> function.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">gr =<span class="st"> </span>Graph<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb11-2" title="2"></a>
<a class="sourceLine" id="cb11-3" title="3">gr<span class="op">$</span><span class="kw">add_pipeop</span>(mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"scale"</span>))</a>
<a class="sourceLine" id="cb11-4" title="4"></a>
<a class="sourceLine" id="cb11-5" title="5">gr<span class="op">$</span><span class="kw">add_pipeop</span>(mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"subsample"</span>, <span class="dt">param_vals =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">frac =</span> <span class="fl">0.1</span>)))</a>
<a class="sourceLine" id="cb11-6" title="6"></a>
<a class="sourceLine" id="cb11-7" title="7">gr<span class="op">$</span><span class="kw">add_edge</span>(<span class="st">"scale"</span>, <span class="st">"subsample"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(gr)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#&gt; Graph with 2 PipeOps:</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">#&gt;         ID         State  sccssors prdcssors</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">#&gt;      scale &lt;&lt;UNTRAINED&gt;&gt; subsample          </span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">#&gt;  subsample &lt;&lt;UNTRAINED&gt;&gt;               scale</span></a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">gr<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>()</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>A <code>Graph</code> itself has a <strong><code>$train()</code></strong> and a <strong><code>$predict()</code></strong> method that accept some data and propagate this data through the network of <code>PipeOp</code>s. The return value corresponds to the output of the <code>PipeOp</code> output channels that are not connected to other input channels.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">gr<span class="op">$</span><span class="kw">train</span>(task)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>()</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co">#&gt;        Species Petal.Length Petal.Width Sepal.Length Sepal.Width</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="co">#&gt;  1:     setosa   -1.3923993  -1.3110521   -1.3807271  0.32731751</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co">#&gt;  2:     setosa   -1.2224563  -1.3110521   -1.2599638  0.78617383</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="co">#&gt;  3:     setosa   -1.3923993  -1.0486668   -0.5353840  1.93331463</span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co">#&gt;  4:     setosa   -1.2791040  -1.3110521   -1.1392005  0.09788935</span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="co">#&gt;  5:     setosa   -1.3923993  -1.3110521   -1.7430170 -0.13153881</span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co">#&gt;  6:     setosa   -1.3923993  -1.1798595   -1.0184372  1.01560199</span></a>
<a class="sourceLine" id="cb14-9" title="9"><span class="co">#&gt;  7:     setosa   -1.3923993  -1.1798595   -1.6222537 -1.73753594</span></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="co">#&gt;  8:     setosa   -1.0525134  -1.0486668   -0.8976739  1.70388647</span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="co">#&gt;  9: versicolor    0.1370873   0.1320673    0.3099591 -0.59039513</span></a>
<a class="sourceLine" id="cb14-12" title="12"><span class="co">#&gt; 10: versicolor    0.4203256   0.5256453    0.1891958  0.78617383</span></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="co">#&gt; 11: versicolor    0.1937350   0.1320673   -0.2938574 -0.13153881</span></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="co">#&gt; 12: versicolor   -0.2594462  -0.2615107   -1.0184372 -1.73753594</span></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="co">#&gt; 13: versicolor    0.3070303   0.1320673    0.4307224 -0.36096697</span></a>
<a class="sourceLine" id="cb14-16" title="16"><span class="co">#&gt; 14:  virginica    0.6469162   0.7880307    0.5514857 -0.81982329</span></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="co">#&gt; 15:  virginica    0.8168591   1.0504160    0.7930124 -0.13153881</span></a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">gr<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(single_line_task)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>()</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co">#&gt;    Species Petal.Length Petal.Width Sepal.Length Sepal.Width</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co">#&gt; 1:  setosa    -1.335752   -1.311052   -0.8976739    1.015602</span></a></code></pre></div>
</div>
<div id="networks" class="section level3">
<h3 class="hasAnchor">
<a href="#networks" class="anchor"></a>Networks</h3>
<p>The example above showed a linear preprocessing pipeline, but it is in fact possible to build true “graphs” of operations, as long as no loops are introduced<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. <code>PipeOp</code>s with multiple output channels can feed their data to multiple different following <code>PipeOp</code>s, and <code>PipeOp</code>s with multiple input channels can take results from different <code>PipeOp</code>s. When a <code>PipeOp</code> has more than one input / output channel, then the <code>Graph</code>’s <code>$add_edge()</code> method needs additional arguments that indicate which channel to connect to. This argument can be given in the form of an integer, or as the name of the channel.</p>
<p>The following constructs a <code>Graph</code> that copies the input and gives one copy each to a “scale” and a “pca” <code>PipeOp</code>. The resulting columns of each operation are put next to each other by “featureunion”.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">gr =<span class="st"> </span>Graph<span class="op">$</span><span class="kw">new</span>()<span class="op">$</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="st">  </span><span class="kw">add_pipeop</span>(mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"copy"</span>, <span class="dt">outnum =</span> <span class="dv">2</span>))<span class="op">$</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">  </span><span class="kw">add_pipeop</span>(mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"scale"</span>))<span class="op">$</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="st">  </span><span class="kw">add_pipeop</span>(mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"pca"</span>))<span class="op">$</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="st">  </span><span class="kw">add_pipeop</span>(mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"featureunion"</span>, <span class="dt">innum =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb16-6" title="6"></a>
<a class="sourceLine" id="cb16-7" title="7">gr<span class="op">$</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="st">  </span><span class="kw">add_edge</span>(<span class="st">"copy"</span>, <span class="st">"scale"</span>, <span class="dt">src_channel =</span> <span class="dv">1</span>)<span class="op">$</span><span class="st">        </span><span class="co"># designating channel by index</span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="st">  </span><span class="kw">add_edge</span>(<span class="st">"copy"</span>, <span class="st">"pca"</span>, <span class="dt">src_channel =</span> <span class="st">"output2"</span>)<span class="op">$</span><span class="st">  </span><span class="co"># designating channel by name</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="st">  </span><span class="kw">add_edge</span>(<span class="st">"scale"</span>, <span class="st">"featureunion"</span>, <span class="dt">dst_channel =</span> <span class="dv">1</span>)<span class="op">$</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="st">  </span><span class="kw">add_edge</span>(<span class="st">"pca"</span>, <span class="st">"featureunion"</span>, <span class="dt">dst_channel =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb16-12" title="12"></a>
<a class="sourceLine" id="cb16-13" title="13">gr<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>()</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">gr<span class="op">$</span><span class="kw">train</span>(iris_first_half)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>()</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co">#&gt;        Species Petal.Length Petal.Width       PC1          PC2</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">#&gt;   1:    setosa   -1.3357516  -1.3110521 -2.561012 -0.006922191</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">#&gt;   2:    setosa   -1.3357516  -1.3110521 -2.561012 -0.006922191</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">#&gt;   3:    setosa   -1.3923993  -1.3110521 -2.653190  0.031849692</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">#&gt;   4:    setosa   -1.2791040  -1.3110521 -2.468834 -0.045694073</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">#&gt;   5:    setosa   -1.3357516  -1.3110521 -2.561012 -0.006922191</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">#&gt;  ---                                                          </span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co">#&gt; 146: virginica    0.8168591   1.4439941  1.755953  0.455479438</span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="co">#&gt; 147: virginica    0.7035638   0.9192234  1.416510  0.164312126</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="co">#&gt; 148: virginica    0.8168591   1.0504160  1.639637  0.178946130</span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="co">#&gt; 149: virginica    0.9301544   1.4439941  1.940308  0.377935674</span></a>
<a class="sourceLine" id="cb17-13" title="13"><span class="co">#&gt; 150: virginica    0.7602115   0.7880307  1.469915  0.033362474</span></a></code></pre></div>
</div>
<div id="syntactic-sugar" class="section level3">
<h3 class="hasAnchor">
<a href="#syntactic-sugar" class="anchor"></a>Syntactic Sugar</h3>
<p>Although it is possible to create intricate <code>Graphs</code> with edges going all over the place (as long as no loops are introduced), usually there is a clear direction of flow between “layers” in the <code>Graph</code>. It is therefore convenient to build up a <code>Graph</code> from layers, which can be done using the <strong><code>%&gt;&gt;%</code></strong> (“double-arrow”) operator. It takes either a <code>PipeOp</code> or a <code>Graph</code> on each of its sides and connects all of the outputs of its left-hand side to one of the inputs each of its right-hand side–the number of inputs therefore must match the number of outputs. Together with the <strong><code><a href="../reference/gunion.html">gunion()</a></code></strong> operation, which takes <code>PipeOp</code>s or <code>Graph</code>s and arranges them next to each other akin to a (disjoint) graph union, the above network can more easily be constructed as follows:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">gr =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"copy"</span>, <span class="dt">outnum =</span> <span class="dv">2</span>) <span class="op">%&gt;&gt;%</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/gunion.html">gunion</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"scale"</span>), mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"pca"</span>))) <span class="op">%&gt;&gt;%</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="st">  </span>mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"featureunion"</span>, <span class="dt">innum =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-4" title="4"></a>
<a class="sourceLine" id="cb18-5" title="5">gr<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>()</a></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
</div>
<div id="learners-in-graphs-graphs-in-learners" class="section level2">
<h2 class="hasAnchor">
<a href="#learners-in-graphs-graphs-in-learners" class="anchor"></a>Learners in Graphs, Graphs in Learners</h2>
<p>The true power of <code>mlr3pipelines</code> derives from the fact that it can be integrated seamlessly with <code>mlr3</code>. Two components are mainly responsible for this:</p>
<ul>
<li>
<strong><code>PipeOpLearner</code></strong>, a <code>PipeOp</code> that encapsulates an <code>mlr3</code> <code>Learner</code> and creates a <code>Prediction</code> object in its <code>$predict()</code> phase</li>
<li>
<strong><code>GraphLearner</code></strong>, a <code>Learner</code> that can be used in place of any other <code>mlr3</code> <code>Learner</code>, but which does prediction using a <code>Graph</code> given to it</li>
</ul>
<div id="pipeoplearner" class="section level3">
<h3 class="hasAnchor">
<a href="#pipeoplearner" class="anchor"></a><code>PipeOpLearner</code>
</h3>
<p>The <code>PipeOpLearner</code> is constructed using an <code>mlr3</code> <code>Learner</code> and will use it to create a <code>Prediction</code> in the <code>$predict()</code> phase. The output during <code>$train()</code> is <code>NULL</code>. It can be used after a preprocessing pipeline, and it is even possible to perform operations on the <code>Prediction</code>, for example by averaging multiple predictions or by using the “backuplearner” to impute predictions that a given model failed to create.</p>
<p>The following is a very simple <code>Graph</code> that performs training and prediction on data after performing principal component analysis.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">gr =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"pca"</span>) <span class="op">%&gt;&gt;%</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="st">  </span>mlr_pipeops<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"learner"</span>, mlr_learners<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"classif.rpart"</span>))</a></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">gr<span class="op">$</span><span class="kw">train</span>(task)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co">#&gt; $classif.rpart.output</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb20-4" title="4"></a>
<a class="sourceLine" id="cb20-5" title="5">gr<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(task)</a>
<a class="sourceLine" id="cb20-6" title="6"><span class="co">#&gt; $classif.rpart.output</span></a>
<a class="sourceLine" id="cb20-7" title="7"><span class="co">#&gt; &lt;PredictionClassif&gt; for 150 observations:</span></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="co">#&gt;      row_id  response     truth</span></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="co">#&gt;   1:      1    setosa    setosa</span></a>
<a class="sourceLine" id="cb20-10" title="10"><span class="co">#&gt;   2:      2    setosa    setosa</span></a>
<a class="sourceLine" id="cb20-11" title="11"><span class="co">#&gt;   3:      3    setosa    setosa</span></a>
<a class="sourceLine" id="cb20-12" title="12"><span class="co">#&gt;  ---                           </span></a>
<a class="sourceLine" id="cb20-13" title="13"><span class="co">#&gt; 148:    148 virginica virginica</span></a>
<a class="sourceLine" id="cb20-14" title="14"><span class="co">#&gt; 149:    149 virginica virginica</span></a>
<a class="sourceLine" id="cb20-15" title="15"><span class="co">#&gt; 150:    150 virginica virginica</span></a></code></pre></div>
</div>
<div id="graphlearner" class="section level3">
<h3 class="hasAnchor">
<a href="#graphlearner" class="anchor"></a><code>GraphLearner</code>
</h3>
<p>Although a <code>Graph</code> has <code>$train()</code> and <code>$predict()</code> functions, it can not be used directly in places where <code>mlr3</code> <code>Learners</code> can be used like resamplin or benchmarks. For this, it needs to be wrapped in a <code>GraphLearner</code> object, which is a thin wrapper that enables this functionality. The resulting learner is extremely versatile, because every part of it can be modified, replaced, parameterized and optimized over. Resampling the graph above can be done the same way that resampling of the <code>Learner</code> was performed in the <a href="#whats-the-point">introductory example</a>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">lrngrph =<span class="st"> </span>GraphLearner<span class="op">$</span><span class="kw">new</span>(gr)</a>
<a class="sourceLine" id="cb21-2" title="2"></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="kw">resample</span>(task, lrngrph, rsmp)</a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co">#&gt; INFO [mlr3] Running learner 'pca.classif.rpart' on task 'iris' (iteration 1/1)'</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co">#&gt; &lt;ResampleResult&gt; of learner 'iris' on task 'pca.classif.rpart' with 1 iterations</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co">#&gt;     Measure Min. 1st Qu. Median Mean 3rd Qu. Max. Sd</span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="co">#&gt;  classif.ce 0.08    0.08   0.08 0.08    0.08 0.08 NA</span></a></code></pre></div>
</div>
</div>
<div id="hyperparameters" class="section level2">
<h2 class="hasAnchor">
<a href="#hyperparameters" class="anchor"></a>Hyperparameters</h2>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>It is tempting to denote this as a “directed acyclic graph”, but the equivalence is not trivial because edges run between channels of <code>PipeOp</code>s, not <code>PipeOp</code>s themselves.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#whats-the-point">What’s the Point</a></li>
      <li>
<a href="#pipeop-pipeline-operators"><code>PipeOp</code>: Pipeline Operators</a><ul class="nav nav-pills nav-stacked">
<li><a href="#why-the-state">Why the <code>$state</code></a></li>
      <li><a href="#where-to-get-pipeops">Where to Get <code>PipeOp</code>s</a></li>
      </ul>
</li>
      <li>
<a href="#pipeop-channels">PipeOp Channels</a><ul class="nav nav-pills nav-stacked">
<li><a href="#input-channels">Input Channels</a></li>
      <li><a href="#output-channels">Output Channels</a></li>
      <li><a href="#channel-configuration">Channel Configuration</a></li>
      </ul>
</li>
      <li>
<a href="#graph-networks-of-pipeops"><code>Graph</code>: Networks of <code>PipeOp</code>s</a><ul class="nav nav-pills nav-stacked">
<li><a href="#basics">Basics</a></li>
      <li><a href="#networks">Networks</a></li>
      <li><a href="#syntactic-sugar">Syntactic Sugar</a></li>
      </ul>
</li>
      <li>
<a href="#learners-in-graphs-graphs-in-learners">Learners in Graphs, Graphs in Learners</a><ul class="nav nav-pills nav-stacked">
<li><a href="#pipeoplearner"><code>PipeOpLearner</code></a></li>
      <li><a href="#graphlearner"><code>GraphLearner</code></a></li>
      </ul>
</li>
      <li><a href="#hyperparameters">Hyperparameters</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><!--<div class="copyright">
  <p>Developed by Martin Binder.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>
--></footer>
</div>

   

  </body>
</html>
