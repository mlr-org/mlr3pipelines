<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Showcase: Branching • mlr3pipelines</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Showcase: Branching">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mlr3pipelines</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Github Version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a_simple_pipeline.html">Showcase: A simple pipeline</a>
    </li>
    <li>
      <a href="../articles/basic_concepts.html">Showcase: Basic Concepts: PipeOp and Graph</a>
    </li>
    <li>
      <a href="../articles/branching.html">Showcase: Branching</a>
    </li>
    <li>
      <a href="../articles/create_a_custom_pipeop.html">Custom PipeOps</a>
    </li>
    <li>
      <a href="../articles/stacking_and_bagging.html">Showcase: Bagging and Stacking</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlr-org/mlr3pipelines">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Showcase: Branching</h1>
                        <h4 class="author">Florian Pfisterer</h4>
            
            <h4 class="date">2019-02-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr3pipelines/blob/master/vignettes/branching.Rmd"><code>vignettes/branching.Rmd</code></a></small>
      <div class="hidden name"><code>branching.Rmd</code></div>

    </div>

    
    
<div id="branching-and-unbranching" class="section level2">
<h2 class="hasAnchor">
<a href="#branching-and-unbranching" class="anchor"></a>Branching and Unbranching</h2>
<p>Consider a scenario, in which there are different options for a given modeling step. A researcher might, in an initial step want to try different options for this. This can be done by specifying <strong>branching</strong> and <strong>unbranching</strong> operators. In the long term, this also allows us to tune over the whole space, i.e. we learn which preprocessing option makes sense for our data.</p>
<p>We will investigate the inner workings of such a Graph. In this example we consider three options for preprocessing our data before we train a model.</p>
<p>In a first step we define the different preprocessing steps: We will consider scaling the data, transforming it using PCA, or not transforming the data at all (using <code>PipeOpNULL</code>).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">op1 =<span class="st"> </span>PipeOpScale<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb1-2" title="2">op2 =<span class="st"> </span>PipeOpPCA<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb1-3" title="3">op3 =<span class="st"> </span>PipeOpNULL<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb1-4" title="4">opts =<span class="st"> </span><span class="kw"><a href="../reference/gunion.html">gunion</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(op1, op2, op3))</a></code></pre></div>
<p>Additionally, we create the learner <code>PipeOp</code>.</p>
<pre class="ŕ"><code>polrn = PipeOpLearner$new(mlr_learners$get("rpart"))</code></pre>
<p>In order to create a mental image of our Pipeline, we have to consider, how the data flows through our computational graph. In case we simply want to do scaling, our pipeline would look like this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">op1 <span class="op">%&gt;&gt;%</span><span class="st"> </span>polrn</a></code></pre></div>
<p>If we want to actively select one <code>PipeOp</code> in a set, we need to add a <code>PipeOp</code> that orchestrates the selection of the following <code>PipeOp</code> using <code>PipeOpBranch</code>. After choosing one <code>PipeOp</code>, all not-selected operators simply recieve a <code>NO_OP</code> object. We can now collect the activated/deactivated <code>PipeOp</code>s again using <code>PipeOpUnBranch</code>. This will become clearer in a short example.</p>
<div id="pipeopbranch" class="section level3">
<h3 class="hasAnchor">
<a href="#pipeopbranch" class="anchor"></a>PipeOpBranch</h3>
<p>We create a <code>PipeOpBranch</code> that let’s us select one of the following <span class="math inline">\(3\)</span> operators. We have to initialize this <code>PipeOp</code> with the number of output branches.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">po_b =<span class="st"> </span>PipeOpBranch<span class="op">$</span><span class="kw">new</span>(<span class="dv">3</span>)</a></code></pre></div>
<p>This can be connected to the different preprocessing features.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">g =<span class="st"> </span>po_b <span class="op">%&gt;&gt;%</span><span class="st"> </span>opts</a></code></pre></div>
</div>
<div id="pipeopunbranch" class="section level3">
<h3 class="hasAnchor">
<a href="#pipeopunbranch" class="anchor"></a>PipeOpUnbranch</h3>
<p>In order to collect the different inputs again, we use the <code>PipeOpUnbranch</code> operator. Again, we have to initialize this operator with the number of inputs it expects.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">po_ub =<span class="st"> </span>PipeOpUnbranch<span class="op">$</span><span class="kw">new</span>(<span class="dv">3</span>)</a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">g =<span class="st"> </span>g <span class="op">%&gt;&gt;%</span><span class="st"> </span>po_ub</a></code></pre></div>
<p>We can visualize the resulting graph before diving into a more detailed explanation.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">g<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>()</a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#branching-and-unbranching">Branching and Unbranching</a><ul class="nav nav-pills nav-stacked">
<li><a href="#pipeopbranch">PipeOpBranch</a></li>
      <li><a href="#pipeopunbranch">PipeOpUnbranch</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Martin Binder.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
