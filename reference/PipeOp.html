<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PipeOp Base Class — PipeOp • mlr3pipelines</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PipeOp Base Class — PipeOp"><meta name="description" content='A PipeOp represents a transformation of a given "input" into a given "output", with two stages: "training"
and "prediction". It can be understood as a generalized function that not only has multiple inputs, but
also multiple outputs (as well as two stages). The "training" stage is used when training a machine learning pipeline or
fitting a statistical model, and the "predicting" stage is then used for making predictions
on new data.
To perform training, the $train() function is called which takes inputs and transforms them, while simultaneously storing information
in its $state slot. For prediction, the $predict() function is called, where the $state information can be used to influence the transformation
of the new data.
A PipeOp is usually used in a Graph object, a representation of a computational graph. It can have
multiple input channels—think of these as multiple arguments to a function, for example when averaging
different models—, and multiple output channels—a transformation may
return different objects, for example different subsets of a Task. The purpose of the Graph is to
connect different outputs of some PipeOps to inputs of other PipeOps.
Input and output channel information of a PipeOp is defined in the $input and $output slots; each channel has a name, a required
type during training, and a required type during prediction. The $train() and $predict() function are called with a list argument
that has one entry for each declared channel (with one exception, see next paragraph). The list is automatically type-checked
for each channel against $input and then passed on to the private$.train() or private$.predict() functions. There the data is processed and
a result list is created. This list is again type-checked for declared output types of each channel. The length and types of the result
list is as declared in $output.
A special input channel name is "...", which creates a vararg channel that takes arbitrarily many arguments, all of the same type. If the $input
table contains an "..."-entry, then the input given to $train() and $predict() may be longer than the number of declared input channels.
This class is an abstract base class that all PipeOps being used in a Graph should inherit from,  and
is not intended to be instantiated.'><meta property="og:description" content='A PipeOp represents a transformation of a given "input" into a given "output", with two stages: "training"
and "prediction". It can be understood as a generalized function that not only has multiple inputs, but
also multiple outputs (as well as two stages). The "training" stage is used when training a machine learning pipeline or
fitting a statistical model, and the "predicting" stage is then used for making predictions
on new data.
To perform training, the $train() function is called which takes inputs and transforms them, while simultaneously storing information
in its $state slot. For prediction, the $predict() function is called, where the $state information can be used to influence the transformation
of the new data.
A PipeOp is usually used in a Graph object, a representation of a computational graph. It can have
multiple input channels—think of these as multiple arguments to a function, for example when averaging
different models—, and multiple output channels—a transformation may
return different objects, for example different subsets of a Task. The purpose of the Graph is to
connect different outputs of some PipeOps to inputs of other PipeOps.
Input and output channel information of a PipeOp is defined in the $input and $output slots; each channel has a name, a required
type during training, and a required type during prediction. The $train() and $predict() function are called with a list argument
that has one entry for each declared channel (with one exception, see next paragraph). The list is automatically type-checked
for each channel against $input and then passed on to the private$.train() or private$.predict() functions. There the data is processed and
a result list is created. This list is again type-checked for declared output types of each channel. The length and types of the result
list is as declared in $output.
A special input channel name is "...", which creates a vararg channel that takes arbitrarily many arguments, all of the same type. If the $input
table contains an "..."-entry, then the input given to $train() and $predict() may be longer than the number of declared input channels.
This class is an abstract base class that all PipeOps being used in a Graph should inherit from,  and
is not intended to be instantiated.'><meta property="og:image" content="https://mlr3pipelines.mlr-org.com/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mlr3pipelines</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-alt"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr3book.mlr-org.com"><span class="fa fa-link"></span> mlr3book</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlr-org/mlr3pipelines/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/"><span class="fa fa-comments"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://stackoverflow.com/questions/tagged/mlr3"><span class="fa fab fa-stack-overflow"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr-org.com/"><span class="fa fa-rss"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>PipeOp Base Class</h1>
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr3pipelines/blob/master/R/PipeOp.R" class="external-link"><code>R/PipeOp.R</code></a></small>
      <div class="d-none name"><code>PipeOp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A <code>PipeOp</code> represents a transformation of a given "input" into a given "output", with two stages: "training"
and "prediction". It can be understood as a generalized function that not only has multiple inputs, but
also multiple outputs (as well as two stages). The "training" stage is used when training a machine learning pipeline or
fitting a statistical model, and the "predicting" stage is then used for making predictions
on new data.</p>
<p>To perform training, the <code>$train()</code> function is called which takes inputs and transforms them, while simultaneously storing information
in its <code>$state</code> slot. For prediction, the <code>$predict()</code> function is called, where the <code>$state</code> information can be used to influence the transformation
of the new data.</p>
<p>A <code>PipeOp</code> is usually used in a <code><a href="Graph.html">Graph</a></code> object, a representation of a computational graph. It can have
multiple <strong>input channels</strong>—think of these as multiple arguments to a function, for example when averaging
different models—, and multiple <strong>output channels</strong>—a transformation may
return different objects, for example different subsets of a <code><a href="https://mlr3.mlr-org.com/reference/Task.html" class="external-link">Task</a></code>. The purpose of the <code><a href="Graph.html">Graph</a></code> is to
connect different outputs of some <code>PipeOp</code>s to inputs of other <code>PipeOp</code>s.</p>
<p>Input and output channel information of a <code>PipeOp</code> is defined in the <code>$input</code> and <code>$output</code> slots; each channel has a <em>name</em>, a required
type during training, and a required type during prediction. The <code>$train()</code> and <code>$predict()</code> function are called with a <code>list</code> argument
that has one entry for each declared channel (with one exception, see next paragraph). The <code>list</code> is automatically type-checked
for each channel against <code>$input</code> and then passed on to the <code>private$.train()</code> or <code>private$.predict()</code> functions. There the data is processed and
a result <code>list</code> is created. This <code>list</code> is again type-checked for declared output types of each channel. The length and types of the result
<code>list</code> is as declared in <code>$output</code>.</p>
<p>A special input channel name is <code>"..."</code>, which creates a <em>vararg</em> channel that takes arbitrarily many arguments, all of the same type. If the <code>$input</code>
table contains an <code>"..."</code>-entry, then the input given to <code>$train()</code> and <code>$predict()</code> may be longer than the number of declared input channels.</p>
<p>This class is an abstract base class that all <code>PipeOp</code>s being used in a <code><a href="Graph.html">Graph</a></code> should inherit from,  and
is not intended to be instantiated.</p>
    </div>


    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>Abstract <code><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="construction">Construction<a class="anchor" aria-label="anchor" href="#construction"></a></h2>



<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>PipeOp<span class="sc">$</span><span class="fu">new</span>(id, <span class="at">param_set =</span> <span class="fu">ps</span>(), <span class="at">param_vals =</span> <span class="fu">list</span>(), input, output, <span class="at">packages =</span> <span class="fu">character</span>(<span class="dv">0</span>), <span class="at">tags =</span> <span class="fu">character</span>(<span class="dv">0</span>))</span></code></pre><p></p></div><ul><li><p><code>id</code> :: <code>character(1)</code><br>
Identifier of resulting object. See <code>$id</code> slot.</p></li>
<li><p><code>param_set</code> :: <code><a href="https://paradox.mlr-org.com/reference/ParamSet.html" class="external-link">ParamSet</a></code> | <code>list</code> of <code>expression</code><br>
Parameter space description. This should be created by the subclass and given to <code>super$initialize()</code>.
If this is a <code><a href="https://paradox.mlr-org.com/reference/ParamSet.html" class="external-link">ParamSet</a></code>, it is used as the <code>PipeOp</code>'s <code><a href="https://paradox.mlr-org.com/reference/ParamSet.html" class="external-link">ParamSet</a></code>
directly. Otherwise it must be a <code>list</code> of expressions e.g. created by <code><a href="https://rdrr.io/r/base/list.html" class="external-link">alist()</a></code> that evaluate to <code><a href="https://paradox.mlr-org.com/reference/ParamSet.html" class="external-link">ParamSet</a></code>s.
These <code><a href="https://paradox.mlr-org.com/reference/ParamSet.html" class="external-link">ParamSet</a></code> are combined using a <code><a href="https://paradox.mlr-org.com/reference/ParamSetCollection.html" class="external-link">ParamSetCollection</a></code>.</p></li>
<li><p><code>param_vals</code> :: named <code>list</code><br>
List of hyperparameter settings, overwriting the hyperparameter settings given in <code>param_set</code>. The
subclass should have its own <code>param_vals</code> parameter and pass it on to <code>super$initialize()</code>. Default <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>.</p></li>
<li><p>input :: <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> with columns <code>name</code> (<code>character</code>), <code>train</code> (<code>character</code>), <code>predict</code> (<code>character</code>)<br>
Sets the <code>$input</code> slot of the resulting object; see description there.</p></li>
<li><p>output :: <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> with columns <code>name</code> (<code>character</code>), <code>train</code> (<code>character</code>), <code>predict</code> (<code>character</code>)<br>
Sets the <code>$output</code> slot of the resulting object; see description there.</p></li>
<li><p>packages :: <code>character</code><br>
Set of all required packages for the <code>PipeOp</code>'s <code>$train</code> and <code>$predict</code> methods. See <code>$packages</code> slot.
Default is <code>character(0)</code>.</p></li>
<li><p><code>tags</code> ::<code>character</code><br>
A set of tags associated with the <code>PipeOp</code>. Tags describe a PipeOp's purpose.
Can be used to filter <code>as.data.table(mlr_pipeops)</code>. Default is <code>"abstract"</code>, indicating an abstract <code>PipeOp</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="internals">Internals<a class="anchor" aria-label="anchor" href="#internals"></a></h2>


<p><code>PipeOp</code> is an abstract class with abstract functions <code>private$.train()</code> and <code>private$.predict()</code>. To create a functional
<code>PipeOp</code> class, these two methods must be implemented. Each of these functions receives a named <code>list</code> according to
the <code>PipeOp</code>'s input channels, and must return a <code>list</code> (names are ignored) with values in the order of output
channels in <code>$output</code>. The <code>private$.train()</code> and <code>private$.predict()</code> function should not be called by the user;
instead, a <code>$train()</code> and <code>$predict()</code> should be used. The most convenient usage is to add the <code>PipeOp</code>
to a <code>Graph</code> (possibly as singleton in that <code>Graph</code>), and using the <code>Graph</code>'s <code>$train()</code> / <code>$predict()</code> methods.</p>
<p><code>private$.train()</code> and <code>private$.predict()</code> should treat their inputs as read-only. If they are <code><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6</a></code> objects,
they should be cloned before being manipulated in-place. Objects, or parts of objects, that are not changed, do
not need to be cloned, and it is legal to return the same identical-by-reference objects to multiple outputs.</p>
    </div>
    <div class="section level2">
    <h2 id="fields">Fields<a class="anchor" aria-label="anchor" href="#fields"></a></h2>


<ul><li><p><code>id</code> :: <code>character</code><br>
ID of the <code>PipeOp</code>. IDs are user-configurable, and IDs of <code>PipeOp</code>s must be unique within a <code><a href="Graph.html">Graph</a></code>. IDs of
<code>PipeOp</code>s must not be changed once they are part of a <code><a href="Graph.html">Graph</a></code>, instead the <code><a href="Graph.html">Graph</a></code>'s <code>$set_names()</code> method
should be used.</p></li>
<li><p><code>packages</code> :: <code>character</code><br>
Packages required for the <code>PipeOp</code>. Functions that are not in base R should still be called using <code>::</code>
(or explicitly attached using <code><a href="https://rdrr.io/r/base/library.html" class="external-link">require()</a></code>) in <code>private$.train()</code> <em>and</em> <code>private$.predict()</code>, but
packages declared here are checked before any (possibly expensive) processing has started within a <code><a href="Graph.html">Graph</a></code>.</p></li>
<li><p><code>param_set</code> :: <code><a href="https://paradox.mlr-org.com/reference/ParamSet.html" class="external-link">ParamSet</a></code><br>
Parameters and parameter constraints. Parameter values that influence the functioning of <code>$train</code> and / or <code>$predict</code> are
in the <code>$param_set$values</code> slot; these are automatically checked against parameter constraints in <code>$param_set</code>.</p></li>
<li><p><code>state</code> :: <code>any</code> | <code>NULL</code><br>
Method-dependent state obtained during training step, and usually required for the prediction step. This is <code>NULL</code>
if and only if the <code>PipeOp</code> has not been trained. The <code>$state</code> is the <em>only</em> slot that can be reliably modified during
<code>$train()</code>, because <code>private$.train()</code> may theoretically be executed in a different <code>R</code>-session (e.g. for parallelization).
<code>$state</code> should furthermore always be set to something with copy-semantics, since it is never cloned. This is a limitation
not of <code>PipeOp</code> or <code>mlr3pipelines</code>, but of the way the system as a whole works, together with <code><a href="mlr_learners_graph.html">GraphLearner</a></code> and <code>mlr3</code>.</p></li>
<li><p>input :: <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> with columns <code>name</code> (<code>character</code>), <code>train</code> (<code>character</code>), <code>predict</code> (<code>character</code>)<br>
Input channels of <code>PipeOp</code>. Column <code>name</code> gives the names (and order) of values in the list given to
<code>$train()</code> and <code>$predict()</code>. Column <code>train</code> is the (S3) class that an input object must conform to during
training, column <code>predict</code> is the (S3) class that an input object must conform to during prediction. Types
are checked by the <code>PipeOp</code> itself and do not need to be checked by <code>private$.train()</code> / <code>private$.predict()</code> code.<br>
A special name is <code>"..."</code>, which creates a <em>vararg</em> input channel that accepts a variable number of inputs.<br>
If a row has both <code>train</code> and <code>predict</code> values enclosed by square brackets ("<code>[</code>", "<code>]</code>), then this channel is
<code><a href="Multiplicity.html">Multiplicity</a></code>-aware. If the <code>PipeOp</code> receives a <code><a href="Multiplicity.html">Multiplicity</a></code> value on these channels, this <code><a href="Multiplicity.html">Multiplicity</a></code>
is given to the <code>.train()</code> and <code>.predict()</code> functions directly. Otherwise, the <code><a href="Multiplicity.html">Multiplicity</a></code> is transparently
unpacked and the <code>.train()</code> and <code>.predict()</code> functions are called multiple times, once for each <code><a href="Multiplicity.html">Multiplicity</a></code> element.
The type enclosed by square brackets indicates that only a <code><a href="Multiplicity.html">Multiplicity</a></code> containing values of this type are accepted.
See <code><a href="Multiplicity.html">Multiplicity</a></code> for more information.</p></li>
<li><p>output :: <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> with columns <code>name</code> (<code>character</code>), <code>train</code> (<code>character</code>), <code>predict</code> (<code>character</code>)<br>
Output channels of <code>PipeOp</code>, in the order in which they will be given in the list returned by <code>$train</code> and
<code>$predict</code> functions. Column <code>train</code> is the (S3) class that an output object must conform to during training,
column <code>predict</code> is the (S3) class that an output object must conform to during prediction. The <code>PipeOp</code> checks
values returned by <code>private$.train()</code> and <code>private$.predict()</code> against these types specifications.<br>
If a row has both <code>train</code> and <code>predict</code> values enclosed by square brackets ("<code>[</code>", "<code>]</code>), then this signals that the channel
emits a <code><a href="Multiplicity.html">Multiplicity</a></code> of the indicated type. See <code><a href="Multiplicity.html">Multiplicity</a></code> for more information.</p></li>
<li><p><code>innum</code> :: <code>numeric(1)</code> <br>
Number of input channels. This equals <code>nrow($input)</code>.</p></li>
<li><p><code>outnum</code> :: <code>numeric(1)</code> <br>
Number of output channels. This equals <code>nrow($output)</code>.</p></li>
<li><p><code>is_trained</code> :: <code>logical(1)</code> <br>
Indicate whether the <code>PipeOp</code> was already trained and can therefore be used for prediction.</p></li>
<li><p><code>tags</code> ::<code>character</code><br>
A set of tags associated with the <code>PipeOp</code>. Tags describe a PipeOp's purpose.
Can be used to filter <code>as.data.table(mlr_pipeops)</code>.
PipeOp tags are inherited and child classes can introduce additional tags.</p></li>
<li><p><code>hash</code> :: <code>character(1)</code> <br>
Checksum calculated on the <code>PipeOp</code>, depending on the <code>PipeOp</code>'s <code>class</code> and the slots <code>$id</code> and <code>$param_set$values</code>. If a
<code>PipeOp</code>'s functionality may change depending on more than these values, it should inherit the <code>$hash</code> active
binding and calculate the hash as <code>digest(list(super$hash, &lt;OTHER THINGS&gt;), algo = "xxhash64")</code>.</p></li>
<li><p><code>phash</code> :: <code>character(1)</code> <br>
Checksum calculated on the <code>PipeOp</code>, depending on the <code>PipeOp</code>'s <code>class</code> and the slots <code>$id</code> but ignoring <code>$param_set$values</code>. If a
<code>PipeOp</code>'s functionality may change depending on more than these values, it should inherit the <code>$hash</code> active
binding and calculate the hash as <code>digest(list(super$hash, &lt;OTHER THINGS&gt;), algo = "xxhash64")</code>.</p></li>
<li><p><code>.result</code> :: <code>list</code> <br>
If the <code><a href="Graph.html">Graph</a></code>'s <code>$keep_results</code> flag is set to <code>TRUE</code>, then the intermediate Results of <code>$train()</code> and <code>$predict()</code>
are saved to this slot, exactly as they are returned by these functions. This is mainly for debugging purposes
and done, if requested, by the <code><a href="Graph.html">Graph</a></code> backend itself; it should <em>not</em> be done explicitly by <code>private$.train()</code> or <code>private$.predict()</code>.</p></li>
<li><p><code>man</code> :: <code>character(1)</code><br>
Identifying string of the help page that shows with <code><a href="https://rdrr.io/r/utils/help.html" class="external-link">help()</a></code>.</p></li>
<li><p><code>properties</code> :: <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code><br>
The properties of the pipeop.
Currently supported values are:</p><ul><li><p><code>"validation"</code>: the <code>PipeOp</code> can make use of the <code>$internal_valid_task</code> of an <code><a href="https://mlr3.mlr-org.com/reference/Task.html" class="external-link">mlr3::Task</a></code>.
This is for example used for <code>PipeOpLearner</code>s that wrap a <code>Learner</code> with this property, see <code><a href="https://mlr3.mlr-org.com/reference/Learner.html" class="external-link">mlr3::Learner</a></code>.
<code>PipeOp</code>s that have this property, also have a <code>$validate</code> field, which controls whether to use the validation task,
as well as a <code>$internal_valid_scores</code> field, which allows to access the internal validation scores after training.</p></li>
<li><p><code>"internal_tuning"</code>: the <code>PipeOp</code> is able to internally optimize hyperparameters.
This works analogously to the internal tuning implementation for <code><a href="https://mlr3.mlr-org.com/reference/Learner.html" class="external-link">mlr3::Learner</a></code>.
<code>PipeOp</code>s with that property also implement the standardized accessor <code>$internal_tuned_values</code> and have at least one
parameter tagged with <code>"internal_tuning"</code>.
An example for such a <code>PipeOp</code> is a <code>PipeOpLearner</code> that wraps a <code>Learner</code> with the <code>"internal_tuning"</code> property.</p></li>
</ul><p>Programatic access to all available properties is possible via <code>mlr_reflections$pipeops$properties</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>


<ul><li><p><code>train(input)</code><br>
(<code>list</code>) -&gt; named <code>list</code><br>
Train <code>PipeOp</code> on <code>inputs</code>, transform it to output and store the learned <code>$state</code>. If the PipeOp is already
trained, already present <code>$state</code> is overwritten. Input list is typechecked against the <code>$input</code> <code>train</code> column.
Return value is a list with as many entries as <code>$output</code> has
rows, with each entry named after the <code>$output</code> <code>name</code> column and class according to the <code>$output</code> <code>train</code> column.
The workhorse function for training each <code>PipeOp</code> is the private
<code>.train(input)</code><br>: (named <code>list</code>) -&gt; <code>list</code><br> function.
It's an Abstract function that must be implemented by concrete subclasses. <code>private$.train()</code> is called by <code>$train()</code> after
typechecking. It must change the <code>$state</code> value to something non-<code>NULL</code> and return a list of transformed data according to
the <code>$output</code> <code>train</code> column. Names of the returned list are ignored.<br>
The <code>private$.train()</code> method should not be called by a user; instead, the <code>$train()</code> method should be used which does some
checking and possibly type conversion.</p></li>
<li><p><code>predict(input)</code> <br>
(<code>list</code>) -&gt; named <code>list</code><br>
Predict on new data in <code>input</code>, possibly using the stored <code>$state</code>. Input and output are specified by <code>$input</code> and <code>$output</code>
in the same way as for <code>$train()</code>, except that
the <code>predict</code> column is used for type checking.
The workhorse function for predicting in each using each <code>PipeOp</code> is
<code>.predict(input)</code><br> (named <code>list</code>) -&gt; <code>list</code><br>
Abstract function that must be implemented by concrete subclasses. <code>private$.predict()</code> is called by <code>$predict()</code> after
typechecking and works analogously to <code>private$.train()</code>. Unlike <code>private$.train()</code>, <code>private$.predict()</code> should not modify
the <code>PipeOp</code> in any way.<br>
Just as <code>private$.train()</code>, <code>private$.predict()</code> should not be called by a user; instead, the <code>$predict()</code> method should be used.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> <br>
() -&gt; <code>NULL</code> <br>
Prints the <code>PipeOp</code>s most salient information: <code>$id</code>, <code>$is_trained</code>, <code>$param_set$values</code>, <code>$input</code> and <code>$output</code>.</p></li>
<li><p><code>help(help_type)</code> <br>
(<code>character(1)</code>) -&gt; help file<br>
Displays the help file of the concrete <code>PipeOp</code> instance. <code>help_type</code> is one of <code>"text"</code>, <code>"html"</code>, <code>"pdf"</code> and behaves
as the <code>help_type</code> argument of R's <code><a href="https://rdrr.io/r/utils/help.html" class="external-link">help()</a></code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="inheriting">Inheriting<a class="anchor" aria-label="anchor" href="#inheriting"></a></h2>


<p>To create your own <code>PipeOp</code>, you need to overload the <code>private$.train()</code> and <code>private$.test()</code> functions.
It is most likely also necessary to overload the <code>$initialize()</code> function to do additional initialization.
The <code>$initialize()</code> method should have at least the arguments <code>id</code> and <code>param_vals</code>, which should be passed on to <code>super$initialize()</code> unchanged.
<code>id</code> should have a useful default value, and <code>param_vals</code> should have the default value <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>, meaning no initialization of hyperparameters.</p>
<p>If the <code>$initialize()</code> method has more arguments, then it is necessary to also overload the <code>private$.additional_phash_input()</code> function.
This function should return either all objects, or a hash of all objects, that can change the function or behavior of the <code>PipeOp</code> and are independent
of the class, the id, the <code>$state</code>, and the <code>$param_set$values</code>. The last point is particularly important: changing the <code>$param_set$values</code> should
<em>not</em> change the return value of <code>private$.additional_phash_input()</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>https://mlr-org.com/pipeops.html</p>
<p>Other mlr3pipelines backend related:
<code><a href="Graph.html">Graph</a></code>,
<code><a href="PipeOpTargetTrafo.html">PipeOpTargetTrafo</a></code>,
<code><a href="PipeOpTaskPreproc.html">PipeOpTaskPreproc</a></code>,
<code><a href="PipeOpTaskPreprocSimple.html">PipeOpTaskPreprocSimple</a></code>,
<code><a href="mlr_graphs.html">mlr_graphs</a></code>,
<code><a href="mlr_pipeops.html">mlr_pipeops</a></code>,
<code><a href="mlr_pipeops_updatetarget.html">mlr_pipeops_updatetarget</a></code></p>
<p>Other PipeOps:
<code><a href="PipeOpEnsemble.html">PipeOpEnsemble</a></code>,
<code><a href="PipeOpImpute.html">PipeOpImpute</a></code>,
<code><a href="PipeOpTargetTrafo.html">PipeOpTargetTrafo</a></code>,
<code><a href="PipeOpTaskPreproc.html">PipeOpTaskPreproc</a></code>,
<code><a href="PipeOpTaskPreprocSimple.html">PipeOpTaskPreprocSimple</a></code>,
<code><a href="mlr_pipeops.html">mlr_pipeops</a></code>,
<code><a href="mlr_pipeops_boxcox.html">mlr_pipeops_boxcox</a></code>,
<code><a href="mlr_pipeops_branch.html">mlr_pipeops_branch</a></code>,
<code><a href="mlr_pipeops_chunk.html">mlr_pipeops_chunk</a></code>,
<code><a href="mlr_pipeops_classbalancing.html">mlr_pipeops_classbalancing</a></code>,
<code><a href="mlr_pipeops_classifavg.html">mlr_pipeops_classifavg</a></code>,
<code><a href="mlr_pipeops_classweights.html">mlr_pipeops_classweights</a></code>,
<code><a href="mlr_pipeops_colapply.html">mlr_pipeops_colapply</a></code>,
<code><a href="mlr_pipeops_collapsefactors.html">mlr_pipeops_collapsefactors</a></code>,
<code><a href="mlr_pipeops_colroles.html">mlr_pipeops_colroles</a></code>,
<code><a href="mlr_pipeops_copy.html">mlr_pipeops_copy</a></code>,
<code><a href="mlr_pipeops_datefeatures.html">mlr_pipeops_datefeatures</a></code>,
<code><a href="mlr_pipeops_encode.html">mlr_pipeops_encode</a></code>,
<code><a href="mlr_pipeops_encodeimpact.html">mlr_pipeops_encodeimpact</a></code>,
<code><a href="mlr_pipeops_encodelmer.html">mlr_pipeops_encodelmer</a></code>,
<code><a href="mlr_pipeops_featureunion.html">mlr_pipeops_featureunion</a></code>,
<code><a href="mlr_pipeops_filter.html">mlr_pipeops_filter</a></code>,
<code><a href="mlr_pipeops_fixfactors.html">mlr_pipeops_fixfactors</a></code>,
<code><a href="mlr_pipeops_histbin.html">mlr_pipeops_histbin</a></code>,
<code><a href="mlr_pipeops_ica.html">mlr_pipeops_ica</a></code>,
<code><a href="mlr_pipeops_imputeconstant.html">mlr_pipeops_imputeconstant</a></code>,
<code><a href="mlr_pipeops_imputehist.html">mlr_pipeops_imputehist</a></code>,
<code><a href="mlr_pipeops_imputelearner.html">mlr_pipeops_imputelearner</a></code>,
<code><a href="mlr_pipeops_imputemean.html">mlr_pipeops_imputemean</a></code>,
<code><a href="mlr_pipeops_imputemedian.html">mlr_pipeops_imputemedian</a></code>,
<code><a href="mlr_pipeops_imputemode.html">mlr_pipeops_imputemode</a></code>,
<code><a href="mlr_pipeops_imputeoor.html">mlr_pipeops_imputeoor</a></code>,
<code><a href="mlr_pipeops_imputesample.html">mlr_pipeops_imputesample</a></code>,
<code><a href="mlr_pipeops_kernelpca.html">mlr_pipeops_kernelpca</a></code>,
<code><a href="mlr_pipeops_learner.html">mlr_pipeops_learner</a></code>,
<code><a href="mlr_pipeops_missind.html">mlr_pipeops_missind</a></code>,
<code><a href="mlr_pipeops_modelmatrix.html">mlr_pipeops_modelmatrix</a></code>,
<code><a href="mlr_pipeops_multiplicityexply.html">mlr_pipeops_multiplicityexply</a></code>,
<code><a href="mlr_pipeops_multiplicityimply.html">mlr_pipeops_multiplicityimply</a></code>,
<code><a href="mlr_pipeops_mutate.html">mlr_pipeops_mutate</a></code>,
<code><a href="mlr_pipeops_nmf.html">mlr_pipeops_nmf</a></code>,
<code><a href="mlr_pipeops_nop.html">mlr_pipeops_nop</a></code>,
<code><a href="mlr_pipeops_ovrsplit.html">mlr_pipeops_ovrsplit</a></code>,
<code><a href="mlr_pipeops_ovrunite.html">mlr_pipeops_ovrunite</a></code>,
<code><a href="mlr_pipeops_pca.html">mlr_pipeops_pca</a></code>,
<code><a href="mlr_pipeops_proxy.html">mlr_pipeops_proxy</a></code>,
<code><a href="mlr_pipeops_quantilebin.html">mlr_pipeops_quantilebin</a></code>,
<code><a href="mlr_pipeops_randomprojection.html">mlr_pipeops_randomprojection</a></code>,
<code><a href="mlr_pipeops_randomresponse.html">mlr_pipeops_randomresponse</a></code>,
<code><a href="mlr_pipeops_regravg.html">mlr_pipeops_regravg</a></code>,
<code><a href="mlr_pipeops_removeconstants.html">mlr_pipeops_removeconstants</a></code>,
<code><a href="mlr_pipeops_renamecolumns.html">mlr_pipeops_renamecolumns</a></code>,
<code><a href="mlr_pipeops_replicate.html">mlr_pipeops_replicate</a></code>,
<code><a href="mlr_pipeops_rowapply.html">mlr_pipeops_rowapply</a></code>,
<code><a href="mlr_pipeops_scale.html">mlr_pipeops_scale</a></code>,
<code><a href="mlr_pipeops_scalemaxabs.html">mlr_pipeops_scalemaxabs</a></code>,
<code><a href="mlr_pipeops_scalerange.html">mlr_pipeops_scalerange</a></code>,
<code><a href="mlr_pipeops_select.html">mlr_pipeops_select</a></code>,
<code><a href="mlr_pipeops_smote.html">mlr_pipeops_smote</a></code>,
<code><a href="mlr_pipeops_spatialsign.html">mlr_pipeops_spatialsign</a></code>,
<code><a href="mlr_pipeops_subsample.html">mlr_pipeops_subsample</a></code>,
<code><a href="mlr_pipeops_targetinvert.html">mlr_pipeops_targetinvert</a></code>,
<code><a href="mlr_pipeops_targetmutate.html">mlr_pipeops_targetmutate</a></code>,
<code><a href="mlr_pipeops_targettrafoscalerange.html">mlr_pipeops_targettrafoscalerange</a></code>,
<code><a href="mlr_pipeops_textvectorizer.html">mlr_pipeops_textvectorizer</a></code>,
<code><a href="mlr_pipeops_threshold.html">mlr_pipeops_threshold</a></code>,
<code><a href="mlr_pipeops_tunethreshold.html">mlr_pipeops_tunethreshold</a></code>,
<code><a href="mlr_pipeops_unbranch.html">mlr_pipeops_unbranch</a></code>,
<code><a href="mlr_pipeops_updatetarget.html">mlr_pipeops_updatetarget</a></code>,
<code><a href="mlr_pipeops_vtreat.html">mlr_pipeops_vtreat</a></code>,
<code><a href="mlr_pipeops_yeojohnson.html">mlr_pipeops_yeojohnson</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># example (bogus) PipeOp that returns the sum of two numbers during $train()</span></span></span>
<span class="r-in"><span><span class="co"># as well as a letter of the alphabet corresponding to that sum during $predict().</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">PipeOpSumLetter</span> <span class="op">=</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></span><span class="op">(</span><span class="st">"sumletter"</span>,</span></span>
<span class="r-in"><span>  inherit <span class="op">=</span> <span class="va">PipeOp</span>,  <span class="co"># inherit from PipeOp</span></span></span>
<span class="r-in"><span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span> <span class="op">=</span> <span class="st">"posum"</span>, <span class="va">param_vals</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">super</span><span class="op">$</span><span class="fu">initialize</span><span class="op">(</span><span class="va">id</span>, param_vals <span class="op">=</span> <span class="va">param_vals</span>,</span></span>
<span class="r-in"><span>        <span class="co"># declare "input" and "output" during construction here</span></span></span>
<span class="r-in"><span>        <span class="co"># training takes two 'numeric' and returns a 'numeric';</span></span></span>
<span class="r-in"><span>        <span class="co"># prediction takes 'NULL' and returns a 'character'.</span></span></span>
<span class="r-in"><span>        input <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"input1"</span>, <span class="st">"input2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          train <span class="op">=</span> <span class="st">"numeric"</span>, predict <span class="op">=</span> <span class="st">"NULL"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        output <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"output"</span>,</span></span>
<span class="r-in"><span>          train <span class="op">=</span> <span class="st">"numeric"</span>, predict <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  private <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># PipeOp deriving classes must implement .train and</span></span></span>
<span class="r-in"><span>    <span class="co"># .predict; each taking an input list and returning</span></span></span>
<span class="r-in"><span>    <span class="co"># a list as output.</span></span></span>
<span class="r-in"><span>    .train <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">sum</span> <span class="op">=</span> <span class="va">input</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">input</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>      <span class="va">self</span><span class="op">$</span><span class="va">state</span> <span class="op">=</span> <span class="va">sum</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sum</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span>,</span></span>
<span class="r-in"><span>    .predict <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="va">self</span><span class="op">$</span><span class="va">state</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">posum</span> <span class="op">=</span> <span class="va">PipeOpSumLetter</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">posum</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PipeOp: &lt;posum&gt; (not trained)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> values: &lt;list()&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Input channels &lt;name [train type, predict type]&gt;:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   input1 [numeric,NULL], input2 [numeric,NULL]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Output channels &lt;name [train type, predict type]&gt;:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   output [numeric,character]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">posum</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $output</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># note the name 'output' is the name of the output channel specified</span></span></span>
<span class="r-in"><span><span class="co"># in the $output data.table.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">posum</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $output</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "c"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Binder, Florian Pfisterer, Lennart Schneider, Bernd Bischl, Michel Lang, Sebastian Fischer, Susanne Dandl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

